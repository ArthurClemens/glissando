!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril/stream")):"function"==typeof define&&define.amd?define(["exports","mithril/stream"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).glissando={},n.Stream)}(this,(function(n,t){"use strict";function i(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var e=i(t),o=function(){return(o=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},r=function(n){return function(t){var i=function(n,t){if(void 0===t||Number.isNaN(t))return{newIndex:n.index,shouldUpdate:!1};var i=Math.min(t,n.count-1);return{newIndex:i,shouldUpdate:i>=0&&i<n.count&&i!==n.index}}(n,t.index),e=i.newIndex;return i.shouldUpdate?o(o(o({},n),t.animate?void 0:{index:e}),{targetIndex:e,isAnimating:!!t.animate}):n}},a=function(n){return function(t){if(n.locations&&n.location){var i=n.locations.indexOf(n.location);if(-1!==i)return n.locations[t(i)]}}};n.GlissandoModel=function(n){void 0===n&&(n={});var t={initialState:function(n){var t=void 0===n?{}:n,i=t.index,e=void 0===i?0:i,r=t.count,a=void 0===r?0:r,u=t.sideViews,c=void 0===u?1:u,d=t.location,s=t.locations,f=Array.from({length:1+2*c},(function(n,t){return t})).map((function(n,t){return t-c})),l=o(o(o({targetIndex:e,index:e,count:a},Array.isArray(s)?{locations:s,count:s?s.length:0,location:s[0]}:void 0),d?{location:d,index:Array.isArray(s)&&s.indexOf(d)||e}:void 0),{isAnimating:!1,direction:"ltr",slots:f,sideViews:c});return l.targetIndex=l.index,l}(n),actions:function(n){return{previous:function(t){var i=(void 0===t?{animate:!0}:t).animate;n((function(n){return r(n)({index:n.index-1,animate:!1!==i})}))},next:function(t){var i=(void 0===t?{animate:!0}:t).animate;n((function(n){return r(n)({index:n.index+1,animate:!1!==i})}))},goTo:function(t){var i=t.index,e=t.location,a=t.animate;n((function(n){if(e){var t={location:e,animate:a};return function(n){return function(t){if(!n.locations||0===n.locations.length)return n;var i=t.location.toString(),e=n.locations.indexOf(i);-1===e&&(e=0,i=n.locations[e]);var a=void 0!==n.location&&!1!==t.animate,u=o(o({},n),{location:i}),c={index:e,animate:a};return r(u)(c)}}(n)(t)}if(void 0===i)return n;var u={index:i,animate:a};return r(n)(u)}))},finalize:function(t){n((function(n){return r(n)({index:t,animate:!1})}))},setCount:function(t){n((function(n){return r(o(o({},n),{count:t}))({index:n.index})}))},setDirection:function(t){n((function(n){return o(o({},n),{direction:t})}))},setLocations:function(t){n((function(n){return o(o({},n),{locations:t,count:t.length})}))}}},selectors:function(n){return{hasNext:function(){var t=n();return t.index<t.count-1},hasPrevious:function(){return n().index>0},isAnimating:function(){return n().isAnimating},getViewIndices:function(){var t=n();return t.slots.map((function(n){var i=n+t.index+0;return n<0&&t.targetIndex<t.index?i=n+t.targetIndex+1:n>0&&t.targetIndex>t.index&&(i=n+t.targetIndex-1),i}))},getLocation:function(){var t=n();return a(t)((function(n){return n}))},getNextLocation:function(){var t=n();return a(t)((function(n){return n+1}))},getPreviousLocation:function(){var t=n();return a(t)((function(n){return n-1}))}}}},i=e.default(),u=e.default.scan((function(n,t){return t(n)}),o({},t.initialState),i),c=o({},t.actions(i)),d=o({},t.selectors(u)),s=e.default.scan((function(n,t){return JSON.stringify(n,null,2)===JSON.stringify(t,null,2)?e.default.SKIP:t}),e.default.SKIP,u),f=e.default.lift((function(n){return n}),s);return o(o({getState:u,getChanges:f},c),d)},n.getSliderStyle=function(n){var t=2*n.sideViews+1,i=100/t,e="rtl"===n.direction?1:-1,r=e*i*(n.sideViews+0);return n.targetIndex>n.index?r=e*i*(n.sideViews+1):n.targetIndex<n.index&&(r=e*i*(n.sideViews-1)),{style:o({width:"calc("+t+" * calc(100%))",transform:"translateX("+r+"%)"},n.isAnimating?void 0:{transitionDuration:"0ms"}),className:n.isAnimating?"glissando-animating":""}},Object.defineProperty(n,"__esModule",{value:!0})}));
//# sourceMappingURL=glissando.js.map
