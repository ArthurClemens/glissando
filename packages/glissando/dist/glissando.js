!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("mithril/stream")):"function"==typeof define&&define.amd?define(["exports","mithril/stream"],t):t((n="undefined"!=typeof globalThis?globalThis:n||self).glissando={},n.Stream)}(this,function(n,t){"use strict";function i(n){return n&&"object"==typeof n&&"default"in n?n:{default:n}}var o=i(t),a=function(){return(a=Object.assign||function(n){for(var t,i=1,e=arguments.length;i<e;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)};function r(e){return function(n){var t=function(n,t){if(void 0===t||Number.isNaN(t))return{newIndex:n.index,shouldUpdate:!1};t=Math.min(t,n.count-1);return{newIndex:t,shouldUpdate:0<=t&&t<n.count&&t!==n.index}}(e,n.index),i=t.newIndex;return t.shouldUpdate?a(a(a({},e),n.animate?void 0:{index:i}),{targetIndex:i,isAnimating:!!n.animate}):e}}function u(i){return function(n){if(i.locations&&i.location){var t=i.locations.indexOf(i.location);if(-1!==t)return i.locations[n(t)]}}}function c(n){var t=void 0===(o=(r=void 0===n?{}:n).index)?0:o,n=void 0===(e=r.count)?0:e,i=void 0===(o=r.sideViews)?1:o,e=r.location,o=r.locations,r=function(){for(var n=0,t=0,i=arguments.length;t<i;t++)n+=arguments[t].length;for(var e=Array(n),o=0,t=0;t<i;t++)for(var r=arguments[t],a=0,u=r.length;a<u;a++,o++)e[o]=r[a];return e}(Array(1+2*i)).map(function(n,t){return t-i});return(r=a(a(a({targetIndex:t,index:t,count:n},Array.isArray(o)?{locations:o,count:o?o.length:0,location:o[0]}:void 0),e?{location:e,index:Array.isArray(o)&&o.indexOf(e)||t}:void 0),{isAnimating:!1,direction:"ltr",slots:r,sideViews:i})).targetIndex=r.index,r}Object.defineProperty(n,"Stream",{enumerable:!0,get:function(){return o.default}}),n.GlissandoModel=function(n){var t={initialState:c(n=void 0===n?{}:n),actions:function(e){return{previous:function(n){var t=(void 0===n?{animate:!0}:n).animate;e(function(n){return r(n)({index:n.index-1,animate:!1!==t})})},next:function(n){var t=(void 0===n?{animate:!0}:n).animate;e(function(n){return r(n)({index:n.index+1,animate:!1!==t})})},goTo:function(n){var t=n.index,i=n.location,o=n.animate;e(function(n){var e;return i?(e=n,function(n){if(!e.locations||0===e.locations.length)return e;var t=n.location.toString(),i=e.locations.indexOf(t);-1===i&&(i=0,t=e.locations[i]);n=void 0!==e.location&&!1!==n.animate,t=a(a({},e),{location:t});return r(t)({index:i,animate:n})}({location:i,animate:o})):void 0===t?n:r(n)({index:t,animate:o})})},finalize:function(t){e(function(n){return r(n)({index:t,animate:!1})})},setCount:function(t){e(function(n){return r(a(a({},n),{count:t}))({index:n.index})})},setDirection:function(t){e(function(n){return a(a({},n),{direction:t})})},setLocations:function(t){e(function(n){return a(a({},n),{locations:t,count:t.length})})}}},selectors:function(t){return{hasNext:function(){var n=t();return n.index<n.count-1},hasPrevious:function(){return 0<t().index},isAnimating:function(){return t().isAnimating},getViewIndices:function(){var i=t();return i.slots.map(function(n){var t=n+i.index+0;return n<0&&i.targetIndex<i.index?t=n+i.targetIndex+1:0<n&&i.targetIndex>i.index&&(t=n+i.targetIndex-1),t})},getLocation:function(){var n=t();return u(n)(function(n){return n})},getNextLocation:function(){var n=t();return u(n)(function(n){return n+1})},getPreviousLocation:function(){var n=t();return u(n)(function(n){return n-1})}}}},i=o.default(),e=o.default.scan(function(n,t){return t(n)},a({},t.initialState),i),n=a({},t.actions(i)),i=a({},t.selectors(e)),t=o.default.scan(function(n,t){return JSON.stringify(n,null,2)===JSON.stringify(t,null,2)?o.default.SKIP:t},o.default.SKIP,e),t=o.default.lift(function(n){return n},t);return a(a({getState:e,getChanges:t},n),i)},n.getSliderStyle=function(n){var t=2*n.sideViews+1,i=100/t,e="rtl"===n.direction?1:-1,o=e*i*(n.sideViews+0);return n.targetIndex>n.index?o=e*i*(n.sideViews+1):n.targetIndex<n.index&&(o=e*i*(n.sideViews-1)),{style:a({width:"calc("+t+" * calc(100%))",transform:"translateX("+o+"%)"},n.isAnimating?void 0:{transitionDuration:"0ms"}),className:n.isAnimating?"glissando-animating":""}},Object.defineProperty(n,"__esModule",{value:!0})});
